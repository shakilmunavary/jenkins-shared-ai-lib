# Guardrails Version: v1.0 â€” Do not modify without version bump

[Rule ID: EC2-001]
Resource Type: aws_instance
Rule: Must use approved AMIs (e.g., hardened or CIS-compliant)
Severity: High
Compliance Check: AMI ID must match approved list or contain "cis" or "hardened" in description

[Rule ID: EC2-002]
Resource Type: aws_instance
Rule: Must have IMDSv2 enabled
Severity: High
Compliance Check: metadata_options.http_tokens must be "required"

[Rule ID: S3-001]
Resource Type: aws_s3_bucket
Rule: Must have encryption enabled (AES256 or KMS)
Severity: High
Compliance Check: server_side_encryption_configuration must be present

[Rule ID: SG-001]
Resource Type: aws_security_group
Rule: Must not allow 0.0.0.0/0 on ports 22 or 3389
Severity: High
Compliance Check: ingress.cidr_blocks must not include 0.0.0.0/0 for ports 22 or 3389
